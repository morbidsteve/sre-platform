---
- name: Restart sshd
  ansible.builtin.systemd:
    name: sshd
    state: restarted

- name: Restart auditd
  # auditd cannot be restarted via systemd â€” this is intentional per RHEL docs
  ansible.builtin.command: service auditd restart  # noqa: command-instead-of-module
  changed_when: true

- name: Reload firewalld
  ansible.builtin.systemd:
    name: firewalld
    state: reloaded

- name: Reboot required
  ansible.builtin.debug:
    msg: >-
      A reboot is required to apply changes (e.g., FIPS mode).
      Reboot the node manually or use the --extra-vars 'reboot_after_hardening=true' flag.
